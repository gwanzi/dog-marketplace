<!--
DogMarket - Frontend Prototype (index.html)
Purpose: Single-file HTML prototype demonstrating a web UI for a multi-vendor dog marketplace
Author: Generated by ChatGPT
How to run: Save as index.html and open in a modern browser.
Notes for developers:
 - This is a front-end prototype only. Replace mock data and localStorage with backend API calls.
 - Suggested backend REST endpoints (examples):
     POST /api/auth/login
     POST /api/auth/register
     GET  /api/products
     POST /api/products
     GET  /api/vendors
     GET  /api/vets?lat={lat}&lng={lng}&radius_km={r}
     POST /api/orders
 - Key integration points and comments are marked with // TODO comments.
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DogMarket — Marketplace Prototype</title>
  <style>
    :root{--accent:#2b8aef;--muted:#666;--card:#fff;--bg:#f4f7fb}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);margin:0;color:#222}
    header{background:#fff;padding:12px 20px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 1px 4px rgba(0,0,0,.06)}
    header h1{margin:0;font-size:18px;color:var(--accent)}
    .container{max-width:1100px;margin:22px auto;padding:0 16px}
    .grid{display:grid;gap:18px}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    .card{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 4px 18px rgba(14,20,30,.04)}
    .controls{display:flex;gap:8px;align-items:center}
    input[type=text],select,textarea{padding:8px;border-radius:8px;border:1px solid #e5e9f0;width:100%}
    button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    .product{display:flex;gap:12px;align-items:center}
    .product img{width:96px;height:72px;object-fit:cover;border-radius:8px}
    .vendor-badge{font-size:12px;background:#eef6ff;color:var(--accent);padding:6px;border-radius:6px}
    .list{display:flex;flex-direction:column;gap:10px}
    .row{display:flex;gap:12px;align-items:center}
    .search-row{display:flex;gap:8px}
    footer{padding:20px;text-align:center;color:#777}
    .pill{padding:6px 10px;background:#f0f6fb;border-radius:999px;font-size:13px}
    .small{font-size:13px}
    .vet-list{display:flex;flex-direction:column;gap:8px}
    .vet-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:#fff}
    nav a{margin-right:12px;color:#333;text-decoration:none}
    .hidden{display:none}
    .badge{background:#eaf8ed;color:#0a662a;padding:6px;border-radius:6px}
    @media (max-width:900px){.grid.cols-3{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;gap:12px">
      <h1>DogMarket</h1>
      <span class="pill">Multi-vendor Marketplace</span>
    </div>
    <nav>
      <a href="#home" data-nav>Home</a>
      <a href="#vendors" data-nav>Vendors</a>
      <a href="#vets" data-nav>Veterinarians</a>
      <a href="#dashboard" data-nav>Dashboard</a>
      <button id="btn-login">Sign in</button>
    </nav>
  </header>

  <main class="container">

    <!-- HOME / SEARCH -->
    <section id="home-section" class="grid cols-3">
      <div class="card">
        <h2>Find dogs, puppies & accessories</h2>
        <p class="muted">Search listings or browse vendor catalogues.</p>
        <div class="search-row" style="margin-top:12px">
          <input id="search-input" type="text" placeholder="Search for breed, accessory, or vendor" />
          <button id="search-btn">Search</button>
        </div>

        <div style="margin-top:14px">
          <h3 class="small">Featured listings</h3>
          <div id="featured" class="list" style="margin-top:8px"></div>
        </div>

      </div>

      <div class="card">
        <h3>Quick actions</h3>
        <div style="margin-top:10px;display:grid;gap:8px">
          <button id="btn-create-listing">Create listing (vendor)</button>
          <button id="btn-register-vet">Register as Vet</button>
          <button id="btn-find-vets">Find vets near me</button>
        </div>

        <hr style="margin:12px 0">
        <h4 class="small">Cart</h4>
        <div id="cart" class="list"></div>
        <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
          <div class="muted" id="cart-total">Total: ₦0</div>
          <button id="btn-checkout">Checkout</button>
        </div>
      </div>

      <div class="card">
        <h3>Discover veterinarians</h3>
        <p class="muted">Licensed vets appear to users based on location.</p>
        <div style="margin-top:10px">
          <label>Search radius (km)</label>
          <select id="vet-radius"><option>5</option><option selected>10</option><option>25</option><option>50</option></select>
          <div style="margin-top:8px"><button id="btn-find-vets-2">Search</button></div>
        </div>
        <div style="margin-top:12px">
          <div id="vet-results" class="vet-list"></div>
        </div>
      </div>
    </section>

    <!-- VENDORS -->
    <section id="vendors-section" class="card hidden" style="margin-top:18px">
      <h2>Vendors & Listings</h2>
      <div class="grid cols-3" style="margin-top:12px">
        <div class="card">
          <h4>All Vendors</h4>
          <div id="vendor-list" class="list" style="margin-top:8px"></div>
        </div>
        <div class="card" style="grid-column:span 2">
          <h4>Marketplace</h4>
          <div id="market-list" class="list" style="margin-top:8px"></div>
        </div>
      </div>
    </section>

    <!-- VETS -->
    <section id="vets-section" class="card hidden" style="margin-top:18px">
      <h2>Veterinarians</h2>
      <p class="muted">Professional profiles and location-based discovery.</p>
      <div id="vets-all" style="margin-top:12px"></div>
    </section>

    <!-- DASHBOARD (vendor) -->
    <section id="dashboard-section" class="card hidden" style="margin-top:18px">
      <h2>Vendor Dashboard (Demo)</h2>
      <p class="muted">Create and manage listings. This demo persists data in localStorage.</p>
      <div style="margin-top:8px">
        <label>Listing title</label>
        <input id="listing-title" type="text" placeholder="e.g. Labrador puppy - 3 months" />
        <label style="margin-top:8px">Price (NGN)</label>
        <input id="listing-price" type="text" placeholder="100000" />
        <label style="margin-top:8px">Image URL</label>
        <input id="listing-image" type="text" placeholder="https://...jpg" />
        <label style="margin-top:8px">Category</label>
        <select id="listing-category">
          <option>Dog</option>
          <option>Puppy</option>
          <option>Accessory</option>
        </select>
        <div style="margin-top:10px"><button id="btn-save-listing">Save Listing</button></div>
      </div>

      <hr style="margin:12px 0">
      <h4>Your listings</h4>
      <div id="dashboard-listings" class="list"></div>
    </section>

  </main>

  <footer>
    Prototype — Not for production. Backend integration required for authentication, storage, payments, compliance.
  </footer>

  <!-- Modals (simple) -->
  <div id="modal" class="hidden" style="position:fixed;left:0;top:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.35)">
    <div id="modal-inner" style="width:760px;max-width:95%;background:#fff;padding:18px;border-radius:12px"></div>
  </div>

  <script>
    // --- Mock data (replace with API calls) ---
    const MOCK_PRODUCTS = [
      {id:1,title:'Labrador Retriever - 4 months',price:120000,category:'Puppy',image:'https://images.dog.ceo/breeds/labrador/n02099712_3001.jpg',vendorId:101},
      {id:2,title:'Premium Dog Leash (leather)',price:5500,category:'Accessory',image:'https://placehold.co/400x300?text=Leash',vendorId:102},
      {id:3,title:'German Shepherd - 6 months',price:150000,category:'Dog',image:'https://images.dog.ceo/breeds/germanshepherd/n02106662_1003.jpg',vendorId:101}
    ];

    const MOCK_VENDORS = [
      {id:101,name:'Happy Paws Kennel',location:'Lagos',rating:4.8},
      {id:102,name:'Urban Pet Supplies',location:'Abuja',rating:4.5}
    ];

    const MOCK_VETS = [
      {id:201,name:'Dr. Amina Bello',clinic:'Lagos Vet Clinic',lat:6.5244,lng:3.3792,license:'VET-001',specialty:'Surgery'},
      {id:202,name:'Dr. John Okonkwo',clinic:'PetCare Abuja',lat:9.0765,lng:7.3986,license:'VET-002',specialty:'Dermatology'}
    ];

    // Local state
    let PRODUCTS = JSON.parse(localStorage.getItem('dm_products')) || MOCK_PRODUCTS.slice();
    let VENDORS = JSON.parse(localStorage.getItem('dm_vendors')) || MOCK_VENDORS.slice();
    let VETS = JSON.parse(localStorage.getItem('dm_vets')) || MOCK_VETS.slice();
    let CART = JSON.parse(localStorage.getItem('dm_cart')) || [];

    // --- Utils ---
    function $(sel){return document.querySelector(sel)}
    function $all(sel){return document.querySelectorAll(sel)}

    // --- Rendering ---
    function renderFeatured(){
      const el = $('#featured'); el.innerHTML='';
      PRODUCTS.slice(0,3).forEach(p=>{
        const div = document.createElement('div'); div.className='product';
        div.innerHTML = `<img src="${p.image}" alt="${p.title}"/><div><strong>${p.title}</strong><div class="muted">₦${p.price.toLocaleString()}</div><div style="margin-top:6px"><button data-add="${p.id}">Add to cart</button></div></div>`;
        el.appendChild(div);
      });
    }

    function renderMarket(){
      const el = $('#market-list'); el.innerHTML='';
      PRODUCTS.forEach(p=>{
        const vendor = VENDORS.find(v=>v.id===p.vendorId) || {name:'Independent'};
        const item = document.createElement('div'); item.className='card product';
        item.innerHTML = `<img src="${p.image}" alt><div style="flex:1"><strong>${p.title}</strong><div class="muted">${vendor.name} • ${p.category}</div></div><div style="text-align:right"><div class="muted">₦${p.price.toLocaleString()}</div><div style="margin-top:8px"><button data-add="${p.id}">Buy</button></div></div>`;
        el.appendChild(item);
      });
    }

    function renderVendors(){
      const el = $('#vendor-list'); el.innerHTML='';
      VENDORS.forEach(v=>{
        const d = document.createElement('div'); d.className='row card';
        d.innerHTML = `<div><strong>${v.name}</strong><div class="muted">${v.location}</div></div><div class="vendor-badge">${v.rating} ★</div>`;
        el.appendChild(d);
      });
    }

    function renderCart(){
      const el = $('#cart'); el.innerHTML='';
      let total=0;
      CART.forEach(ci=>{
        const p = PRODUCTS.find(x=>x.id==ci.productId);
        total += (p.price * ci.qty);
        const row = document.createElement('div'); row.className='row';
        row.innerHTML = `<div style="display:flex;gap:8px;align-items:center"><img src="${p.image}" style="width:48px;height:36px;border-radius:6px"><div><strong>${p.title}</strong><div class="muted">₦${p.price.toLocaleString()}</div></div></div><div><input type="number" min="1" value="${ci.qty}" data-qty="${ci.productId}" style="width:68px"></div>`;
        el.appendChild(row);
      });
      $('#cart-total').textContent = `Total: ₦${total.toLocaleString()}`;
      localStorage.setItem('dm_cart', JSON.stringify(CART));
    }

    function renderDashboardListings(){
      const el = $('#dashboard-listings'); el.innerHTML='';
      PRODUCTS.forEach(p=>{
        const d = document.createElement('div'); d.className='row card';
        d.innerHTML = `<div style="display:flex;gap:10px;align-items:center"><img src="${p.image}" width=64 height=48 style="object-fit:cover;border-radius:8px"><div><strong>${p.title}</strong><div class="muted">₦${p.price.toLocaleString()}</div></div></div><div><button data-del="${p.id}">Delete</button></div>`;
        el.appendChild(d);
      });
    }

    function renderVetsAll(){
      const el = $('#vets-all'); el.innerHTML='';
      VETS.forEach(v=>{
        const d = document.createElement('div'); d.className='card';
        d.innerHTML = `<strong>${v.name}</strong> <div class="muted">${v.clinic} • ${v.specialty}</div><div style="margin-top:8px"><button data-contact="${v.id}">View profile</button></div>`;
        el.appendChild(d);
      });
    }

    // --- Event wiring ---
    document.addEventListener('click',e=>{
      const add = e.target.dataset.add; if(add){ addToCart(parseInt(add)); return }
      const del = e.target.dataset.del; if(del){ deleteListing(parseInt(del)); return }
      const contact = e.target.dataset.contact; if(contact){ openVetProfile(parseInt(contact)); return }
    });

    $('#search-btn').addEventListener('click',()=>{
      const q = $('#search-input').value.trim().toLowerCase();
      // Basic client-side filter
      const results = PRODUCTS.filter(p=>p.title.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
      $('#market-list').innerHTML='';
      results.forEach(p=>{
        const item = document.createElement('div'); item.className='card product';
        item.innerHTML = `<img src="${p.image}" alt><div style="flex:1"><strong>${p.title}</strong><div class="muted">${p.category}</div></div><div style="text-align:right"><div class="muted">₦${p.price.toLocaleString()}</div><div style="margin-top:8px"><button data-add="${p.id}">Buy</button></div></div>`;
        $('#market-list').appendChild(item);
      });
    });

    $('#btn-create-listing').addEventListener('click',()=>{ navigateTo('dashboard'); });
    $('#btn-register-vet').addEventListener('click',()=>{ openVetRegistration(); });
    $('#btn-find-vets').addEventListener('click',()=>{ findVetsByGeolocation(); });
    $('#btn-find-vets-2').addEventListener('click',()=>{ findVetsByGeolocation(); });

    $('#btn-save-listing').addEventListener('click',()=>{
      const title = $('#listing-title').value.trim(); const price = parseInt($('#listing-price').value||0);
      const img = $('#listing-image').value.trim()||'https://placehold.co/400x300?text=No+image';
      const cat = $('#listing-category').value;
      if(!title||!price){ alert('Please provide title and price'); return }
      const id = Date.now();
      const newP = {id,title,price,category:cat,image:img,vendorId:101};
      PRODUCTS.unshift(newP);
      localStorage.setItem('dm_products', JSON.stringify(PRODUCTS));
      renderDashboardListings(); renderMarket(); renderFeatured();
      alert('Listing saved (local demo). Integrate backend API to persist.');
    });

    $('#btn-checkout').addEventListener('click',()=>{
      if(CART.length===0){ alert('Cart is empty'); return }
      // TODO: call backend POST /api/orders
      alert('Checkout simulated. Implement payment integration and order API on the backend.');
      CART = []; localStorage.setItem('dm_cart',JSON.stringify(CART)); renderCart();
    });

    document.addEventListener('input',e=>{
      const pid = e.target.dataset.qty; if(pid){
        const q = parseInt(e.target.value)||1; const idx = CART.findIndex(c=>c.productId==pid);
        if(idx>=0){ CART[idx].qty = q; localStorage.setItem('dm_cart',JSON.stringify(CART)); renderCart() }
      }
    });

    function addToCart(productId){
      const idx = CART.findIndex(c=>c.productId==productId);
      if(idx>=0) CART[idx].qty += 1; else CART.push({productId,qty:1});
      localStorage.setItem('dm_cart',JSON.stringify(CART)); renderCart();
    }

    function deleteListing(id){ PRODUCTS = PRODUCTS.filter(p=>p.id!==id); localStorage.setItem('dm_products',JSON.stringify(PRODUCTS)); renderDashboardListings(); renderMarket(); }

    function openVetRegistration(){
      showModal(`<h3>Register as Veterinarian</h3>
        <div style='display:grid;gap:8px'>
          <input id='vet-name' placeholder='Full name' />
          <input id='vet-clinic' placeholder='Clinic name' />
          <input id='vet-license' placeholder='License number' />
          <input id='vet-lat' placeholder='Latitude (optional)' />
          <input id='vet-lng' placeholder='Longitude (optional)' />
          <div style='display:flex;gap:8px'><button id='vet-save'>Save</button><button id='vet-cancel'>Cancel</button></div>
        </div>`);
      $('#vet-save').addEventListener('click',()=>{
        const name = $('#vet-name').value.trim(); const clinic = $('#vet-clinic').value.trim(); const license = $('#vet-license').value.trim();
        const lat = parseFloat($('#vet-lat').value) || null; const lng = parseFloat($('#vet-lng').value) || null;
        if(!name||!clinic||!license){ alert('Please complete required fields'); return }
        const id = Date.now(); VETS.push({id,name,clinic,license,lat:lat||6.5244,lng:lng||3.3792,specialty:'General'});
        localStorage.setItem('dm_vets',JSON.stringify(VETS)); closeModal(); renderVetsAll(); alert('Vet registered locally — backend registration endpoint required');
      });
      $('#vet-cancel').addEventListener('click',closeModal);
    }

    function openVetProfile(id){
      const v = VETS.find(x=>x.id==id); if(!v) return;
      showModal(`<h3>${v.name}</h3><div class='muted'>${v.clinic} • ${v.specialty}</div><p class='muted'>License: ${v.license}</p><div style='margin-top:10px'><button id='book-vet'>Message / Book</button> <button id='close-vet'>Close</button></div>`);
      $('#book-vet').addEventListener('click',()=>{ alert('Booking flow: call backend to create appointment or chat.'); });
      $('#close-vet').addEventListener('click',closeModal);
    }

    // --- Geolocation + simple proximity filter (Haversine) ---
    function haversineKm(lat1,lon1,lat2,lon2){
      const R=6371; const dLat=(lat2-lat1)*Math.PI/180; const dLon=(lon2-lon1)*Math.PI/180;
      const a = Math.sin(dLat/2)*Math.sin(dLat/2) + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); return R*c;
    }

    function findVetsByGeolocation(){
      const radius = parseInt($('#vet-radius').value||10);
      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos=>{
          const lat = pos.coords.latitude; const lng = pos.coords.longitude;
          const nearby = VETS.map(v=>({...v,dist:haversineKm(lat,lng,v.lat,v.lng)})).filter(v=>v.dist<=radius).sort((a,b)=>a.dist-b.dist);
          renderVetResults(nearby);
        },err=>{ alert('Geolocation failed or permission denied. Showing vets list.'); renderVetResults(VETS); });
      } else { alert('Geolocation not supported'); renderVetResults(VETS); }
    }

    function renderVetResults(list){
      const el = $('#vet-results'); el.innerHTML='';
      if(list.length===0){ el.innerHTML='<div class="muted">No vets found in radius.</div>'; return }
      list.forEach(v=>{
        const d = document.createElement('div'); d.className='vet-item';
        d.innerHTML = `<div><strong>${v.name}</strong><div class='muted'>${v.clinic} • ${v.specialty}</div></div><div><div class='muted'>${v.dist?Math.round(v.dist)+' km':''}</div><div style='margin-top:6px'><button data-contact='${v.id}'>View</button></div></div>`;
        el.appendChild(d);
      });
    }

    // --- Simple modal helpers ---
    function showModal(html){ $('#modal-inner').innerHTML = html; $('#modal').classList.remove('hidden'); }
    function closeModal(){ $('#modal').classList.add('hidden'); $('#modal-inner').innerHTML=''; }

    // --- Navigation ---
    function navigateTo(name){
      document.querySelectorAll('section').forEach(s=>s.classList.add('hidden'));
      if(name==='home') $('#home-section').classList.remove('hidden');
      if(name==='vendors') $('#vendors-section').classList.remove('hidden');
      if(name==='vets') $('#vets-section').classList.remove('hidden');
      if(name==='dashboard') $('#dashboard-section').classList.remove('hidden');
      if(name==='dashboard') window.scrollTo({top:0,behavior:'smooth'});
    }

    // nav anchors
    document.querySelectorAll('[data-nav]').forEach(a=>a.addEventListener('click',ev=>{ ev.preventDefault(); const href = a.getAttribute('href').replace('#',''); navigateTo(href); }));

    // --- Initialization ---
    function init(){ renderFeatured(); renderMarket(); renderVendors(); renderCart(); renderDashboardListings(); renderVetsAll(); navigateTo('home'); }
    init();

    // --- Expose for debugging in devtools ---
    window.__DM = {PRODUCTS,VENDORS,VETS,CART};

    // --- Integration notes for programmers ---
    /*
      - Replace localStorage flows with fetch()/axios calls to backend endpoints.
      - Use authentication (JWT/OAuth) for vendor and vet registration flows.
      - Use a proper image upload (S3 or CDN) for vendor/product images.
      - Add payments: integrate Paystack/Flutterwave/Stripe depending on region.
      - Compliance: vet license verification, KYC for high-value sellers.
      - Mobile: this UI can be wrapped in a WebView or reimplemented in React Native / Flutter.
      - Add pagination, search indexing, and upload validation on backend.
    */
  </script>
</body>
</html>
